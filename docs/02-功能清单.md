# SecondMe - 功能清单

## 前端功能

### 话题管理

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 新建话题 | 点击按钮创建新的对话会话 | P0 |
| 话题列表 | 左侧边栏显示所有历史话题 | P0 |
| 切换话题 | 点击话题进入，加载完整聊天记录 | P0 |
| 删除话题 | 删除不需要的话题 | P1 |
| 话题标题 | 由 AI 根据首次对话自动生成 | P0 |

### 对话功能

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 发送消息 | 输入框输入问题，发送给 AI | P0 |
| 接收回复 | 显示 AI 的回复内容 | P0 |
| 流式输出 | AI 回复逐字显示（打字机效果） | P1 |
| 聊天记录 | 显示当前话题的完整对话历史 | P0 |
| 选择模型 | 对话时可选择服务商和模型 | P0 |

### 服务商管理

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 添加服务商 | 配置新的 AI 服务商（名称、Base URL、API Key） | P0 |
| 服务商列表 | 查看已配置的所有服务商 | P0 |
| 编辑服务商 | 修改服务商配置 | P0 |
| 删除服务商 | 删除不需要的服务商 | P1 |
| 拉取模型 | 获取服务商可用的模型列表 | P0 |
| 设置默认 | 设置默认对话服务商/模型 | P1 |

### 记忆管理

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 记忆列表 | 查看所有记忆（文本形式） | P0 |
| 使用统计 | 显示每条记忆被使用次数 | P0 |
| 使用详情 | 查看记忆在哪些对话中被使用 | P1 |
| 添加记忆 | 用户主动添加自定义记忆 | P0 |
| 删除记忆 | 删除不需要的记忆 | P1 |
| 编辑记忆 | 修改已有记忆内容 | P2 |

### 界面布局

```
┌──────────────────────────────────────────────────────────────────┐
│  SecondMe                    [服务商▼] [模型▼]     [+ 新话题]    │
├──────────────┬───────────────────────────────────────────────────┤
│              │                                                   │
│  话题列表     │              对话区域                             │
│              │                                                   │
│  - 话题1     │  用户: xxx                                        │
│  - 话题2     │  AI: xxx                                          │
│  - 话题3     │                                                   │
│              │                                                   │
│ ──────────── │                                                   │
│  [⚙️ 设置]   ├───────────────────────────────────────────────────┤
│  [🧠 记忆]   │  [输入框]                                 [发送]  │
└──────────────┴───────────────────────────────────────────────────┘

设置页面：服务商配置、向量化模型选择
记忆页面：记忆列表、添加记忆、使用统计
```

## 后端功能

### 会话管理

| 功能 | API | 描述 |
|------|-----|------|
| 创建话题 | POST /api/topics | 创建新话题，返回话题ID |
| 话题列表 | GET /api/topics | 获取所有话题 |
| 获取话题 | GET /api/topics/{id} | 获取单个话题详情 |
| 删除话题 | DELETE /api/topics/{id} | 删除话题及其消息 |
| 更新标题 | PATCH /api/topics/{id} | 更新话题标题 |

### 消息管理

| 功能 | API | 描述 |
|------|-----|------|
| 发送消息 | POST /api/topics/{id}/messages | 发送消息并获取 AI 回复 |
| 消息列表 | GET /api/topics/{id}/messages | 获取话题的所有消息 |

### 服务商管理

| 功能 | API | 描述 |
|------|-----|------|
| 添加服务商 | POST /api/providers | 添加新服务商配置 |
| 服务商列表 | GET /api/providers | 获取所有服务商 |
| 更新服务商 | PUT /api/providers/{id} | 更新服务商配置 |
| 删除服务商 | DELETE /api/providers/{id} | 删除服务商 |
| 获取模型列表 | GET /api/providers/{id}/models | 拉取服务商的可用模型 |

### 记忆管理

| 功能 | API | 描述 |
|------|-----|------|
| 记忆列表 | GET /api/memories | 获取所有记忆及使用统计 |
| 记忆详情 | GET /api/memories/{id} | 获取记忆详情及使用记录 |
| 添加记忆 | POST /api/memories | 用户主动添加记忆 |
| 删除记忆 | DELETE /api/memories/{id} | 删除记忆 |
| 更新记忆 | PUT /api/memories/{id} | 更新记忆内容 |

### AI 功能

| 功能 | 描述 |
|------|------|
| 对话生成 | 调用指定服务商/模型生成回复 |
| 标题生成 | 首次对话后自动生成话题标题 |
| 记忆注入 | 将检索到的相关记忆注入 prompt |
| 向量化 | 使用指定服务商/模型进行文本向量化 |

### 记忆系统

| 功能 | 描述 |
|------|------|
| 向量化存储 | 每条对话存入向量数据库 |
| 相关检索 | 根据当前问题检索相关历史 |
| 跨话题检索 | 检索范围为所有话题 |
| 使用记录 | 记录每次记忆被使用的情况 |
| 手动记忆 | 支持用户主动添加的记忆 |

## 配置功能

### 服务商配置（支持多个）

| 配置项 | 描述 |
|--------|------|
| 名称 | 服务商显示名称（如 "OpenAI"、"DeepSeek"） |
| Base URL | API 服务地址 |
| API Key | 服务密钥 |
| 是否启用 | 是否在选择列表中显示 |

### 模型配置

| 配置项 | 描述 |
|--------|------|
| 默认对话服务商 | 对话默认使用的服务商 |
| 默认对话模型 | 对话默认使用的模型 |
| 向量化服务商 | 向量化使用的服务商 |
| 向量化模型 | 向量化使用的模型 |

## 优先级说明

- **P0**: 核心功能，必须实现
- **P1**: 重要功能，优先实现
- **P2**: 增强功能，后续迭代
